<!doctype html>
<html lang="en">
<!-- This is a generated file. Do not edit. -->
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>3D rasters are powerful and you already know how to use them</title>

        <meta name="description" content="US-IALE 2017 3D raster (voxel model) talk">
        <meta name="author" content="Vaclav Petras">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/ncsu-geoforall-lab.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">
        <!-- For chalkboard plugin -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

        <!-- If the query includes 'print-pdf', include the PDF print sheet -->
        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->

        <style>
            pre {
                font-size: 100% !important;
            }
        </style>
    </head>

    <body>

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
<section>
    <h2>3D rasters are powerful</h2>
    <h3> and you already know how to use them</h3>
    <h3 style="margin-top: 0.5em">
        Vaclav (Vashek) Petras,</h3>
    <h4>Anna Petrasova and Helena Mitasova
    <p class="title-foot">
        <a href="http://www.ncsu.edu/" title="North Carolina State University">NCSU</a>
        <a href="http://geospatial.ncsu.edu/osgeorel/" title="NCSU OSGeo Research and Education Laboratory">OSGeoREL</a>
        at the
        <a href="http://geospatial.ncsu.edu/" title="Center for Geospatial Analytics">Center for Geospatial Analytics</a>
        <br>
        North Carolina State University
    </p>
    <p>
        US-IALE, Baltimore<br>
        April 9-13, 2017
    </p>
</section>


<section>
<h2>3D rasters</h2>
<p>
Usage:
soil properties,
concentrations in water bodies,
properties of air mass,
hyperspectral data,
analysis of spatio-temporal data,
forest and habitat properties,
exploration of simulation scenario space
</p>
<ul>
    <li><strong>3D raster</strong> - Voxel space - 3D voxel grid - Voxel model
    <li><strong>[3D] cell</strong> - Voxel - 3D voxel unit - Volumetric pixel
</ul>
<img src="img/raster3d_layout.png" class="stretch">
<p class="credit">
    Image credit:
    <a href="https://grass.osgeo.org/grass72/manuals/raster3dintro.html">GRASS Development Team</a>
</p>
</section>


<section>
<div class="left">
    <h3>Series of 2D rasters</h3>
<ul>
    <li>2D does not explicitly represent and model 3D relationships
    <li>2D rasters accessible individually
</ul>
<img src="img/raster2d_series.png" style="width: 100%;">
</div>
<div class="right">
    <h3>3D raster</h3>
    <ul>
        <li>explicit 3D relationships
        <li>unified access to all 3 dimensions
        <li>needs to be sliced to get 2D rasters
    </ul>
<img src="img/raster3d_stack.png" style="width: 100%;">
</div>
</section>


<section>
<h3>Third dimension</h3>
<ul>
    <li>The first two dimensions are the same as in 2D.
    <li>Third dimension can be in space, time, or scenario space.
    <li>Mind the possible anisotropy in the Z direction.
        <br><small>(difference from 2D rasters where all directions are isotropic most of the time)</small>
</ul>
</section>


<section>
<h2>Working with 3D rasters</h2>
Not that different from 2D rasters, images, and matrices
</section>


<section>
<h2>Python</h2>
<ul>
    <li>using NumPy array
</ul>
<pre class="python" style="width: 50%;"><code>x = array([[[ 0,  1,  2],
            [ 3,  4,  5],
            [ 6,  7,  8]],
           [[ 9, 10, 11],
            [12, 13, 14],
            [15, 16, 17]],
           [[18, 19, 20],
            [21, 22, 23],
            [24, 25, 26]]])
x.sum(axis=0)
# array([[27, 30, 33],
#        [36, 39, 42],
#        [45, 48, 51]])
</code></pre>
<img src="img/logos/python.svg" class="stretch">
</section>


<section>
<h2>R</h2>
<ul>
    <li>using array
</ul>
<pre class="r" style="width: 50%;"><code>x = array(1:40, dim=c(2,4,5))
# , , 1
#
#      [,1] [,2] [,3] [,4]
# [1,]    1    3    5    7
# [2,]    2    4    6    8
#
# , , 2
# ...
x[2,3,3]
# 22
x[2,3,3] = 0
</code></pre>
<img src="img/logos/r.svg" class="stretch">
</section>


<section>
<h2>Octave</h2>
<ul>
    <li>using 3D matrix/array
</ul>
<pre class="octave" style="width: 50%;"><code>x = reshape(1:8, 2, 2, 2)
a(2,1,1) = 5
b = 3 * a
# b =
#
# ans(:,:,1) =
#
#     3    9
#    15   12
</code></pre>
<img src="img/logos/octave.svg" class="stretch">
</section>


<section>
<h2>GRASS GIS</h2>
<p>
    <em>general-purpose geospatial analysis and remote sensing tool</em>
</p>
<ul>
    <li>
        data types:
        <ul>
            <li>vectors
            <li>2D rasters
            <li><strong>3D rasters</strong>
        </ul>
    <li>
        container types:
        <ul>
            <li>imagery groups
                <ul>
                    <li><strong>series of 2D rasters</strong>
                </ul>
            <li>spatio-temporal datasets
                <ul>
                    <li><strong>series of 2D rasters</strong>
                    <small>(or vectors or 3D rasters)</small>
                </ul>
        </ul>
</ul>
<br>
<img src="img/logos/grassgis.svg" class="stretch">
</section>


<section>
<h2>Moving window</h2>

<h3>2D</h3>

<pre class="bash" style="width: 100%;"><code>r.neighbors input=a output=b method=average size=5
r.colors map=b color=viridis
</code></pre>

<h3>3D</h3>

<pre class="bash" style="width: 100%;"><code>r3.neighbors input=a output=b method=average window=5,5,5
r3.colors map=b color=viridis
</code></pre>

</section>


<section>
<h2>3D raster algebra</h2>

<pre style="width: 55%;"><code>b = a + 2
</code></pre>

<pre style="width: 55%;"><code>b = if(a > 20, 1, null())
</code></pre>

<pre style="width: 55%;"><code>b = (a[0,0,-1] + a[0,0,1]) / 2
</code></pre>

</section>


<section>
<h2>Visual programming</h2>
<ul>
    <li>graphical modeler
    <li>graphical raster calculator
</ul>
<img src="img/graphical_modeler.png" class="stretch">
</section>


<section>
<h2>Example: Terrain evolution</h2>
<img src="img/jr_animation_2d.gif" class="stretch">
</section>


<section>
<h2>Example: Terrain evolution</h2>
<img src="img/jr16animation.gif" class="left">
<img src="img/jr20animation.gif" class="right">
<img src="img/raster3d_from_2d.png" class="stretch">
<p class="credit">
    <small>
    Image credit:
    <a href="https://grass.osgeo.org/grass72/manuals/r.to.rast3.html">GRASS Development Team</a>
    </small>
</p>
</section>


<section>
<h2>Example: Behavioral patterns</h2>
<img src="img/amos_animation_2d.gif" class="stretch">
<p>
Petrasova
</p>
</section>


<section>
<h2>Example: Behavioral patterns</h2>
spatio-temporal data representing behavioral patterns of people in urban environment
<br>
<img src="img/amos_animation_3d.gif" class="stretch">
<p>
<small>
Petrasova
</small>
</p>
</section>


<section>
<h2>Example: Vegetation structure</h2>
3D vegetation structure derived from lidar point clouds
<small class="glow">
    Petras, V., D. J. Newcomb, and H. Mitasova.
    <em>Generalized 3D fragmentation index derived from lidar point clouds.</em>
    In: Open Geospatial Data, Software and Standards [in print]
</small>
<img src="img/fragmentation_paper.png" class="stretch box-glow">
<p class="credit">3D version of forest fragmentation index by Riitters et al.</p>
</section>


<section>
    <h3>3D index of 3D raster</h3>
    <img class="stretch" src="img/raster3d.png">
</section>


<section>
    <h3>Point cloud</h3>
    <img class="stretch" src="img/points3d.png">
</section>


<section>
    <h3>Binning, moving window &amp; raster algebra</h3>

<pre class="bash" style="width: 100%; font-size: 75% !important;"><code># Bash
r3.in.lidar input=points.las n=count base_raster=ground -d class_filter=3,4,5
r3.neighbors input=count output=average method=average window=3,3,3
r3.mapcalc expression="buffer = if(average > 0, 1, 0)"
</code></pre>

    <img class="stretch" src="img/profile2d_presence.png">
    <img style="width: 10%;" src="img/count_legend.png">
</section>


<section>
    <h3>Fragmentation index</h3>

<pre class="python" style="width: 97%; font-size: 85% !important;"><code># Python
import grass.script as gs
gs.run_command("g.extension", extension="r3.forestfrag")
gs.run_command("r3.forestfrag", input="buffer", output="fragmentation")
</code></pre>

    <!-- stretch does not work well here -->
    <img style="width: 100%;" src="img/profile2d_ff.png">
    <br>
    <img style="width: 20%;" src="img/ff_legend.png">
</section>


<section>
    <h3>Profile of 3D raster</h3>
    <img class="stretch" src="img/profiles3d.png">
</section>


<section>
    <h3>Back to 2D</h3>

<img style="width: 20%;" src="img/count_categories.png">

<pre class="bash" style="width: 90%;"><code># Bash
r3.count.categories input=fragmentation output=count
g.list type=raster pattern="count_*"
</code></pre>

    <img class="stretch" src="img/relative_count.png">
    <br>

</section>

<section>
    <h3>Conclusion</h3>
<ul>
    <li>there is a third dimension
    <li>3D rasters can handle it
    <li>use the tool you know
    <li>pick the tool closest to what you know
</ul>

<p style="text-align: left; width: 40%; margin-left: auto; margin-right: auto;">
    <img src="img/logos/grassgis.svg" style="width: 10%; vertical-align: middle;">
    GRASS GIS
    <a href="http://grass.osgeo.org">grass.osgeo.org</a>
    <br>
    <img src="img/logos/python.svg" style="width: 10%; vertical-align: middle;">
    Python
    <a href="http://python.org">python.org</a>
    <br>
    <img src="img/logos/r.svg" style="width: 10%; vertical-align: middle;">
    R
    <a href="https://www.r-project.org/">r-project.org</a>
    <br>
    <img src="img/logos/octave.svg" style="width: 10%; vertical-align: middle;">
    Octave
    <a href="https://www.gnu.org/software/octave/">octave.org</a>
</p>
<p>
    <a href="https://github.com/wenzeslaus">github.com/wenzeslaus</a>
</section>
<!-- This is a generated file. Do not edit. -->
        </div>  <!-- slides -->

    </div>  <!-- reveal -->
    <!--
        Home button or link to a parent page
        If you want this to be unique for every page (slide deck),
        then remove it from here and put it at the end of each
        file (or series of files) creating one page
        (the position will be little different)
        TODO: some JS is needed to move it to the right position
    -->
    <div class="parent-page">
        <!-- alternative symbol: &#x1f3e0; -->
        <a href="https://github.com/ncsu-osgeorel/lecture-slides-template" title="Go to the repository">
            <img width="15px" src="img/home.svg"></a>
    </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>

            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                // Display controls in the bottom right corner
                controls: false,

                // Display a presentation progress bar
                progress: true,
                
                center: true,
                
                // Display the page number of the current slide
                slideNumber: false,

                // Enable the slide overview mode
                overview: true,

                // Turns fragments on and off globally
                fragments: true,

                // The "normal" size of the presentation, aspect ratio will be preserved
                // when the presentation is scaled to fit different resolutions. Can be
                // specified using percentage units.
                // width: 960,
                // height: 700,
                
                // Factor of the display size that should remain empty around the content
                margin: 0.05,  // increase?

                // Bounds for smallest/largest possible scale to apply to content
                minScale: 0.5,
                maxScale: 5.0,

                theme: Reveal.getQueryHash().theme,  // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none

                // Push each slide change to the browser history
                history: true,
                // Enable keyboard shortcuts for navigation
                keyboard: true,

                // Vertical centering of slides
                center: true,

                // Enables touch navigation on devices with touch input
                touch: true,

                // Loop the presentation
                loop: false,
                // Flags if the presentation is running in an embedded mode,
                // i.e. contained within a limited portion of the screen
                embedded: false,

                // Number of milliseconds between automatically proceeding to the
                // next slide, disabled when set to 0, this value can be overwritten
                // by using a data-autoslide attribute on your slides
                autoSlide: 0,

                // Stop auto-sliding after user input
                autoSlideStoppable: true,

                // Enable slide navigation via mouse wheel
                mouseWheel: false,

                // Hides the address bar on mobile devices
                hideAddressBar: true,

                // Opens links in an iframe preview overlay
                previewLinks: false,

                // Transition speed
                transitionSpeed: 'default', // default/fast/slow

                // Transition style for full page slide backgrounds
                backgroundTransition: 'none', // default/none/slide/concave/convex/zoom

                // Number of slides away from the current that are visible
                viewDistance: 3,

                // Parallax background image
                //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

                // Parallax background size
                //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"
                chalkboard: { 
        		// optionally load pre-recorded chalkboard drawing from file
            		src: "chalkboard.json",
            	},
                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/math/math.js', async: true },
                    { src: 'plugin/chalkboard/chalkboard.js' }
                ],
                keyboard: {
            	    67: function() { RevealChalkboard.toggleNotesCanvas() },	// toggle notes canvas when 'c' is pressed
            	    66: function() { RevealChalkboard.toggleChalkboard() },	// toggle chalkboard when 'b' is pressed
            	    46: function() { RevealChalkboard.clear() },	// clear chalkboard when 'DEL' is pressed
            	     8: function() { RevealChalkboard.reset() },	// reset chalkboard data on current slide when 'BACKSPACE' is pressed
            	    68: function() { RevealChalkboard.download() },	// downlad recorded chalkboard drawing when 'd' is pressed
            	},
            });

        </script>

    </body>
</html>
